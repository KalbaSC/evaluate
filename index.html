<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>بوابة المدربين - نادي كلباء</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
    <style>
        @font-face {
            font-family: 'NotoKufiArabic';
            src: url('https://kalbasc.github.io/reports/NotoKufiArabic.ttf') format('truetype');
        }
        body {
            font-family: 'NotoKufiArabic', sans-serif;
            background: #111;
            color: white;
            margin: 0;
            padding: 0;
        }
        .header-container {
            background: #111;
            border-bottom: 2px solid #f4e733;
            padding: 15px 0;
        }
        .header-content {
            max-width: 1200px;
            margin: 0 auto;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 20px;
        }
        .logo {
            height: 60px;
        }
        .divider {
            width: 1.5px;
            height: 45px;
            background-color: #f4e733;
        }
        .header-info {
            text-align: center;
        }
        .arabic-name {
            font-weight: bold;
            font-size: 18px;
        }
        .english-name {
            font-size: 12px;
            color: #f4e733;
        }
        .container {
            max-width: 1200px;
            margin: 20px auto;
            padding: 20px;
            background: rgba(0, 0, 0, 0.7);
            border-radius: 10px;
        }
        h1 {
            color: #f4e733;
            text-align: center;
            margin-bottom: 20px;
        }
        .login-form {
            max-width: 400px;
            margin: 0 auto;
            padding: 20px;
            background: #222;
            border-radius: 10px;
            border: 1px solid #f4e733;
        }
        .form-group {
            margin-bottom: 15px;
        }
        label {
            display: block;
            margin-bottom: 5px;
            color: #f4e733;
        }
        input, select {
            width: 100%;
            padding: 10px;
            border-radius: 5px;
            border: 1px solid #f4e733;
            background: #111;
            color: white;
        }
        button {
            background: #f4e733;
            color: black;
            border: none;
            padding: 10px 15px;
            border-radius: 5px;
            cursor: pointer;
            width: 100%;
            font-weight: bold;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }
        th, td {
            border: 1px solid #f4e733;
            padding: 10px;
            text-align: center;
        }
        th {
            background-color: #333;
            color: #f4e733;
        }
        .evaluation-form {
            display: none;
            margin-top: 20px;
            padding: 15px;
            background: #222;
            border-radius: 10px;
            border: 1px solid #f4e733;
        }
        .evaluation-options {
            display: flex;
            gap: 10px;
            margin-top: 10px;
        }
        .evaluation-options label {
            display: flex;
            align-items: center;
            gap: 5px;
            cursor: pointer;
        }
        textarea {
            width: 100%;
            padding: 10px;
            border-radius: 5px;
            border: 1px solid #f4e733;
            background: #111;
            color: white;
            resize: vertical;
            min-height: 100px;
        }
        .hidden {
            display: none;
        }
        .coach-dashboard {
            display: none;
        }
        .activity-selector {
            margin-bottom: 20px;
        }
        .summary-card {
            background: #222;
            padding: 15px;
            border-radius: 10px;
            border: 1px solid #f4e733;
            margin-bottom: 20px;
        }
        .empty-state {
            text-align: center;
            padding: 20px;
            color: #aaa;
        }
        @media (max-width: 768px) {
            .header-content {
                flex-direction: column;
                gap: 10px;
            }
            .divider {
                width: 80%;
                height: 1.5px;
            }
            .logo {
                height: 50px;
            }
            th, td {
                padding: 5px;
                font-size: 12px;
            }
        }
    </style>
</head>
<body>
    <header class="header-container">
        <div class="header-content">
            <img src="Picture3.png" alt="شعار الشارقة" class="logo">
            <div class="divider"></div>
            <img src="logo.png" alt="شعار نادي كلباء" class="logo">
            <div class="header-info">
                <div class="arabic-name">نادي كلباء الرياضي الثقافي</div>
                <div class="english-name">KALBA SPORTS & CULTURAL CLUB</div>
            </div>
        </div>
    </header>

    <div class="container">
        <!-- Login Section -->
        <div id="loginSection">
            <h1>تسجيل دخول المدربين</h1>
            <div class="login-form">
                <div class="form-group">
                    <label for="coachName">اسم المدرب:</label>
                    <input type="text" id="coachName" placeholder="أدخل اسمك">
                </div>
                <div class="form-group">
                    <label for="activity">النشاط:</label>
                    <select id="activity">
                        <option value="">اختر النشاط</option>
                        <!-- Activities will be populated by JavaScript -->
                    </select>
                </div>
                <div class="form-group">
                    <label for="password">كلمة المرور:</label>
                    <input type="password" id="password" placeholder="أدخل كلمة المرور">
                </div>
                <button onclick="loginCoach()">تسجيل الدخول</button>
            </div>
        </div>

        <!-- Coach Dashboard -->
        <div id="coachDashboard" class="coach-dashboard">
            <h1>مرحبا بك، <span id="welcomeCoach"></span></h1>
            <div class="summary-card">
                <h2 id="activityTitle"></h2>
                <p>عدد المشاركين: <span id="participantCount">0</span></p>
                <p>آخر تحديث: <span id="lastUpdate"></span></p>
            </div>

            <div class="activity-selector">
                <label for="attendanceDate">اختر تاريخ:</label>
                <input type="date" id="attendanceDate">
            </div>

            <table id="attendanceTable">
                <thead>
                    <tr>
                        <th>التاريخ</th>
                        <th>الاسم</th>
                        <th>المعرف</th>
                        <th>الحضور</th>
                        <th>التقييم</th>
                        <th>إجراءات</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td colspan="6" class="empty-state">اختر تاريخًا لعرض البيانات</td>
                    </tr>
                </tbody>
            </table>

            <div id="evaluationForm" class="evaluation-form">
                <h3>تقييم المشارك</h3>
                <div class="form-group">
                    <label for="participantName">اسم المشارك:</label>
                    <input type="text" id="participantName" readonly>
                </div>
                <div class="form-group">
                    <label for="participantId">المعرف:</label>
                    <input type="text" id="participantId" readonly>
                </div>
                <div class="form-group">
                    <label>التقييم:</label>
                    <div class="evaluation-options">
                        <label><input type="radio" name="evaluation" value="ممتاز"> ممتاز</label>
                        <label><input type="radio" name="evaluation" value="جيد جدا"> جيد جداً</label>
                        <label><input type="radio" name="evaluation" value="جيد"> جيد</label>
                        <label><input type="radio" name="evaluation" value="مقبول"> مقبول</label>
                        <label><input type="radio" name="evaluation" value="ضعيف"> ضعيف</label>
                    </div>
                </div>
                <div class="form-group">
                    <label for="evaluationNotes">ملاحظات:</label>
                    <textarea id="evaluationNotes" placeholder="أدخل ملاحظاتك عن المشارك"></textarea>
                </div>
                <button onclick="saveEvaluation()">حفظ التقييم</button>
                <button onclick="cancelEvaluation()" style="background: #555; margin-top: 10px;">إلغاء</button>
            </div>
        </div>
    </div>

    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script>
        // Sample data - in a real app, this would come from your database
        const coaches = [
            { name: "مدرب كرة القدم", activity: "كرة القدم", password: "football123" },
            { name: "مدرب السباحة", activity: "السباحة", password: "swimming123" },
            { name: "مدرب الرسم", activity: "الرسم", password: "art123" }
        ];

        const activities = ["كرة القدم", "السباحة", "الرسم", "الكاراتيه", "الجمباز"];
        
        // Sample attendance data - in a real app, this would come from your main system
        let attendanceData = [];
        
        // Current coach info
        let currentCoach = null;
        let currentActivityData = [];

        // Initialize the page
        $(document).ready(function() {
            // Populate activities dropdown
            const activitySelect = $('#activity');
            activities.forEach(activity => {
                activitySelect.append(`<option value="${activity}">${activity}</option>`);
            });
            
            // Set default date to today
            const today = new Date().toISOString().split('T')[0];
            $('#attendanceDate').val(today);
            
            // Load sample data (in a real app, you would fetch this from your API)
            loadSampleData();
        });

        function loadSampleData() {
            // This is just sample data - replace with actual data from your system
            attendanceData = [
                {
                    id: "1001",
                    name: "محمد أحمد",
                    activity: "كرة القدم",
                    date: "2025-07-20",
                    timestamp: "2025-07-20T10:15:00",
                    attendance: "حاضر",
                    evaluation: "",
                    notes: ""
                },
                {
                    id: "1002",
                    name: "علي خالد",
                    activity: "كرة القدم",
                    date: "2025-07-20",
                    timestamp: "2025-07-20T10:20:00",
                    attendance: "حاضر",
                    evaluation: "جيد",
                    notes: "أداء جيد ولكن يحتاج لتحسين التمريرات"
                },
                {
                    id: "1003",
                    name: "سارة محمد",
                    activity: "السباحة",
                    date: "2025-07-20",
                    timestamp: "2025-07-20T11:00:00",
                    attendance: "حاضر",
                    evaluation: "ممتاز",
                    notes: "أداء رائع في تعلم السباحة الحرة"
                },
                {
                    id: "1004",
                    name: "يوسف عمر",
                    activity: "الرسم",
                    date: "2025-07-21",
                    timestamp: "2025-07-21T09:30:00",
                    attendance: "حاضر",
                    evaluation: "",
                    notes: ""
                }
            ];
        }

        function loginCoach() {
            const coachName = $('#coachName').val().trim();
            const activity = $('#activity').val();
            const password = $('#password').val();
            
            if (!coachName || !activity || !password) {
                alert("الرجاء إدخال جميع البيانات المطلوبة");
                return;
            }
            
            // Check if coach exists (in a real app, this would be a server-side check)
            const coach = coaches.find(c => 
                c.name === coachName && 
                c.activity === activity && 
                c.password === password
            );
            
            if (!coach) {
                alert("بيانات الدخول غير صحيحة");
                return;
            }
            
            currentCoach = coach;
            
            // Show coach dashboard
            $('#loginSection').addClass('hidden');
            $('#coachDashboard').removeClass('hidden');
            
            // Update welcome message
            $('#welcomeCoach').text(coachName);
            $('#activityTitle').text(`نشاط: ${activity}`);
            
            // Load data for this coach's activity
            loadActivityData(activity);
        }

        function loadActivityData(activity) {
            // Filter attendance data for this activity
            currentActivityData = attendanceData.filter(item => item.activity === activity);
            
            // Update participant count
            const uniqueParticipants = [...new Set(currentActivityData.map(item => item.id))];
            $('#participantCount').text(uniqueParticipants.length);
            
            // Set last update time
            const now = new Date();
            $('#lastUpdate').text(now.toLocaleString('ar-EG'));
            
            // Load data for today by default
            filterAttendanceByDate();
        }

        function filterAttendanceByDate() {
            const selectedDate = $('#attendanceDate').val();
            if (!selectedDate) return;
            
            const filteredData = currentActivityData.filter(item => item.date === selectedDate);
            
            const tbody = $('#attendanceTable tbody');
            tbody.empty();
            
            if (filteredData.length === 0) {
                tbody.append('<tr><td colspan="6" class="empty-state">لا يوجد بيانات لهذا التاريخ</td></tr>');
                return;
            }
            
            filteredData.forEach(item => {
                const row = `
                    <tr>
                        <td>${formatDate(item.timestamp)}</td>
                        <td>${item.name}</td>
                        <td>${item.id}</td>
                        <td>${item.attendance}</td>
                        <td>${item.evaluation || "-"}</td>
                        <td>
                            <button onclick="openEvaluation('${item.id}', '${item.name}')" style="padding: 5px 10px; font-size: 12px;">
                                ${item.evaluation ? "تعديل التقييم" : "إضافة تقييم"}
                            </button>
                        </td>
                    </tr>
                `;
                tbody.append(row);
            });
        }

        function openEvaluation(participantId, participantName) {
            // Find participant data
            const participantData = currentActivityData.find(item => 
                item.id === participantId && 
                item.date === $('#attendanceDate').val()
            );
            
            // Fill evaluation form
            $('#participantName').val(participantName);
            $('#participantId').val(participantId);
            
            if (participantData.evaluation) {
                $(`input[name="evaluation"][value="${participantData.evaluation}"]`).prop('checked', true);
            } else {
                $('input[name="evaluation"]').prop('checked', false);
            }
            
            $('#evaluationNotes').val(participantData.notes || '');
            
            // Show evaluation form
            $('#evaluationForm').show();
            $('html, body').animate({
                scrollTop: $('#evaluationForm').offset().top
            }, 500);
        }

        function saveEvaluation() {
            const participantId = $('#participantId').val();
            const evaluation = $('input[name="evaluation"]:checked').val();
            const notes = $('#evaluationNotes').val();
            
            if (!evaluation) {
                alert("الرجاء اختيار تقييم");
                return;
            }
            
            // Update the data (in a real app, this would save to your database)
            const selectedDate = $('#attendanceDate').val();
            
            const index = currentActivityData.findIndex(item => 
                item.id === participantId && 
                item.date === selectedDate
            );
            
            if (index !== -1) {
                currentActivityData[index].evaluation = evaluation;
                currentActivityData[index].notes = notes;
                
                // Also update the main attendance data (for demo purposes)
                const mainIndex = attendanceData.findIndex(item => 
                    item.id === participantId && 
                    item.date === selectedDate
                );
                
                if (mainIndex !== -1) {
                    attendanceData[mainIndex].evaluation = evaluation;
                    attendanceData[mainIndex].notes = notes;
                }
            }
            
            // Refresh the table
            filterAttendanceByDate();
            
            // Hide the evaluation form
            $('#evaluationForm').hide();
            
            alert("تم حفظ التقييم بنجاح");
        }

        function cancelEvaluation() {
            $('#evaluationForm').hide();
        }

        function formatDate(isoString) {
            const date = new Date(isoString);
            const options = {
                year: 'numeric', 
                month: '2-digit', 
                day: '2-digit',
                hour: '2-digit', 
                minute: '2-digit',
                hour12: true
            };
            let formatted = date.toLocaleString('ar-EG', options);
            formatted = formatted.replace("AM", "ص").replace("PM", "م");
            return formatted;
        }

        // Event listeners
        $('#attendanceDate').change(function() {
            filterAttendanceByDate();
        });
    </script>
</body>
</html>
